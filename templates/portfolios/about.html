{% extends "portfolio_base.html" %}
{% block title %}{{ profile.fullname }} | About{% endblock %}
{% block head %}
<style>
  .pencil img {
    padding-left: 2px;
  }
  .pencil {
    text-decoration: none;
  }
  .pencil:hover {
    text-decoration: none;
  }
  a:hover {
    text-decoration: none;
  }
  #email-link {
    color: #{{ profile.text_color }};
    text-decoration: none;
  }
</style>
{% endblock %}
{% block script %}
{% if user.is_authenticated and user.username == username %}
<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/csrf.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/editor.js"></script>
<script>
$(document).ready(function(){
  $('.pencil').hover(function () {
    $(this).find('img').prop('src', '{{ STATIC_URL}}img/pencil.png');
  }, function () {
    $(this).find('img').prop('src', '{{ STATIC_URL}}img/pencil_dull.png');
  });

  $(".enable-about").on("click", function() {
    if (!$(this).hasClass("active")) {
      $(this).removeClass("btn-default");
      $(this).addClass("btn-success active");
      $(".disable-about").removeClass("btn-danger active");
      $(".disable-about").addClass("btn-default");

      $.ajax({
        type: "POST",
        url: "/toggle_about_page/",
        data: {'enable': 'True'}
      });
    }
  });

  $(".disable-about").on("click", function() {
    if (!$(this).hasClass("active")) {
      $(this).removeClass("btn-default");
      $(this).addClass("btn-danger active");
      $(".enable-about").removeClass("btn-success active");
      $(".enable-about").addClass("btn-default");

      $.ajax({
        type: "POST",
        url: "/toggle_about_page/",
        data: {'enable': 'False'}
      });
    }
  });
  $('#id_picture').change(function() {
    $('#id_picture_styled').val($(this).val().replace("C:\\fakepath\\", ""));
  });
});
</script>
{% endif %}
{% endblock %}
{% block content %}
{% if user.is_authenticated and user.username == username %}
<div class="alert alert-error hide" id="ajax-alert">
  <a class="close" data-dismiss="alert" href="#">&times;</a>
  <p></p>
</div>
<!-- Modal for uploading a profile picture -->
<div class="modal hide" role="dialog" tabindex="-1" id="profile-picture-modal" arialabelledby="profile-picture-heading">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
    <h3 id="profile-picture-heading" style="color: #424242">Profile Picture</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="/edit_profile_picture/" enctype="multipart/form-data">
      {% csrf_token %}
      <input type="file" name="picture" id="id_picture" class="hide"/>
      <div class="pretty_file_input">
	<input id="id_picture_styled" type="text" onclick="$('#id_picture').click();" placeholder="Image file">
	<a class="btn btn-default" onclick="$('#id_picture').click();" style="margin-bottom: 10px"><b>Browse</b></a>
      </div>
      <div style="padding-top: 15px">
	<input type="submit" value="Upload" class="btn btn-primary btn-large">
	<button class="btn btn-default btn-large" data-dismiss="modal" aria-hidden="true">Close</button>
      </div>
    </form>
  </div>
</div>
<!-- Modal for removing the profile picture -->
<div class="modal hide" role="dialog" tabindex="-1" id="delete-profile-picture" arialabelledby="delete-picture-heading">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
    <h3 id="delete-picture-heading" style="color: #424242">Delete profile picture?</h3>
  </div>
  <div class="modal-body">
    <div style="padding-top: 15px">
      <a href="/about/delete_photo/" class="btn btn-danger btn-large">Delete</a>
      <button class="btn btn-default btn-large" data-dismiss="modal" aria-hidden="true">Cancel</button>
    </div>
  </div>
</div>
<!-- End modal -->
{% endif %}
<div class="row-fluid muted">
  <div class="span9">
    {% if user.is_authenticated and username == user.username %}
    <div class="row-fluid" style="padding-bottom: 10px">
      <div class="span2">
	<p><b>Enable?</b></p>
      </div>
      <div class="span7">
	<div class="btn-group" data-toggle="buttons-radio" style="display: inline">
	  {% if profile.allow_about %}
	  <button type="button" class="btn btn-success enable-about active" value="True"><i class="icon-ok"></i></button>
	  <button type="button" class="btn btn-default disable-about" value="False"><i class="icon-remove"></i></button>
	  {% else %}
	  <button type="button" class="btn btn-default enable-about" value="True"><i class="icon-ok"></i></button>
	  <button type="button" class="btn btn-danger disable-about active" value="False"><i class="icon-remove"></i></button>
	  {% endif %}
	</div>
      </div>
    </div>
    {% endif %}

    {% if user.is_authenticated and username == user.username or profile.about %}
    <div class="row-fluid">
      <div class="span2">
	{% if user.is_authenticated and username == user.username %}
	<a class="pencil muted" id="trigger-editable-about" href="#"><b>About</b><img src="{{ STATIC_URL }}img/pencil_dull.png"></a>
	{% elif profile.about %}
	<p><b>About</b></p>
	{% endif %}
      </div>
      <div class="span10">
	{% if user.is_authenticated and username == user.username %}
	<div id="editable-about">
	  {% if profile.about %}
	  <p id="valid-about">{{ profile.about|linebreaksbr }}</p>
	  {% else %}
	  <p id="empty-about"><em>Currently empty</em></p>
	  {% endif %}
	  <textarea id="about-textarea" style="display: none; width: 100%"></textarea>
	</div>
	<button type="button" class="btn btn-success" id="save-about" style="display: none; margin-bottom: 10px">
	  <b>Save</b>
	</button>
	<button type="button" class="btn btn-default" id="cancel-about" style="display: none; margin-bottom: 10px">
	  <i class="icon-remove"></i>
	</button>
	{% elif profile.about %}
	<p>{{ profile.about|linebreaksbr }}</p>
	{% endif %}
      </div>
    </div>
    {% endif %}

    {% if user.is_authenticated and username == user.username or profile.email %}
    <div class="row-fluid">
      <div class="span2">
	{% if user.is_authenticated and username == user.username %}
	<a class="pencil muted" id="trigger-editable-email" href="#"><b>Email</b><img src="{{ STATIC_URL }}img/pencil_dull.png"></a>
	{% elif profile.email %}
	<p><b>Email</b></p>
	{% endif %}
      </div>
      <div class="span10">
	{% if user.is_authenticated and username == user.username %}
	<div id="editable-email">
	  {% if profile.email %}
	  <p id="valid-email">{{ profile.email }}</p>
	  {% else %}
	  <p id="empty-email"><em>Currently empty</em></p>
	  {% endif %}
	  <input id="email-input" type="text" style="display: none"></input>
	</div>
	<button type="button" class="btn btn-success" id="save-email" style="display: none; margin-bottom: 10px">
	  <b>Save</b>
	</button>
	<button type="button" class="btn btn-default" id="cancel-email" style="display: none; margin-bottom: 10px">
	  <i class="icon-remove"></i>
	</button>
	{% elif profile.email %}
	<a id="email-link" href="mailto:{{ profile.email }}">{{ profile.email }}</a>
	{% endif %}
      </div>
    </div>
    {% endif %}

    {% if user.is_authenticated and username == user.username or profile.phone %}
    <div class="row-fluid">
      <div class="span2">
	{% if user.is_authenticated and username == user.username %}
	<a class="pencil muted" id="trigger-editable-phone" href="#"><b>Phone</b><img src="{{ STATIC_URL }}img/pencil_dull.png"></a>
	{% elif profile.phone %}
	<p><b>Phone</b></p>
	{% endif %}
      </div>
      <div class="span10">
	{% if user.is_authenticated and username == user.username %}
	<div id="editable-phone">
	  {% if profile.phone %}
	  <p id="valid-phone">{{ profile.phone }}</p>
	  {% else %}
	  <p id="empty-phone"><em>Currently empty</em></p>
	  {% endif %}
	  <input id="phone-input" type="text" style="display: none" maxlength="100"></input>
	</div>
	<button type="button" class="btn btn-success" id="save-phone" style="display: none; margin-bottom: 10px">
	  <b>Save</b>
	</button>
	<button type="button" class="btn btn-default" id="cancel-phone" style="display: none; margin-bottom: 10px">
	  <i class="icon-remove"></i>
	</button>
	{% elif profile.phone %}
	<p>{{ profile.phone }}</p>
	{% endif %}
      </div>
    </div>
    {% endif %}

    {% if user.is_authenticated and username == user.username or profile.location %}
    <div class="row-fluid">
      <div class="span2">
	{% if user.is_authenticated and username == user.username %}
	<a class="pencil muted" id="trigger-editable-location" href="#"><b>Location</b><img src="{{ STATIC_URL }}img/pencil_dull.png"></a>
	{% elif profile.location %}
	<p><b>Location</b></p>
	{% endif %}
      </div>
      <div class="span10">
	{% if user.is_authenticated and username == user.username %}
	<div id="editable-location">
	  {% if profile.location %}
	  <p id="valid-location">{{ profile.location }}</p>
	  {% else %}
	  <p id="empty-location"><em>Currently empty</em></p>
	  {% endif %}
	  <input id="location-input" type="text" style="display: none" maxlength="100"></input>
	</div>
	<button type="button" class="btn btn-success" id="save-location" style="display: none; margin-bottom: 10px">
	  <b>Save</b>
	</button>
	<button type="button" class="btn btn-default" id="cancel-location" style="display: none; margin-bottom: 10px">
	  <i class="icon-remove"></i>
	</button>
	{% elif profile.location %}
	<p>{{ profile.location }}</p>
	{% endif %}
      </div>
    </div>
    {% endif %}

    {% if user.is_authenticated and username == user.username or profile.website %}
    <div class="row-fluid">
      <div class="span2">
	{% if user.is_authenticated and username == user.username %}
	<a class="pencil muted" id="trigger-editable-website" href="#"><b>Website</b><img src="{{ STATIC_URL }}img/pencil_dull.png"></a>
	{% elif profile.website %}
	<p><b>Website</b></p>
	{% endif %}
      </div>
      <div class="span10">
	{% if user.is_authenticated and username == user.username %}
	<div id="editable-website">
	  {% if profile.website %}
	  <a id="valid-website" href="{{ profile.website }}" target="_blank" style="text-decoration: none">{{ profile.website }}</a>
	  {% else %}
	  <p id="empty-website"><em>Currently empty</em></p>
	  {% endif %}
	  <input id="website-input" type="text" style="display: none" maxlength="500"></input>
	</div>
	<button type="button" class="btn btn-success" id="save-website" style="display: none; margin-bottom: 10px">
	  <b>Save</b>
	</button>
	<button type="button" class="btn btn-default" id="cancel-website" style="display: none; margin-bottom: 10px">
	  <i class="icon-remove"></i>
	</button>
	{% elif profile.website %}
	<a href="{{ profile.website }}" target="_blank" style="text-decoration: none">{{ profile.website }}</a>
	{% endif %}
      </div>
    </div>
    {% endif %}

    <div class="row-fluid">
      <div class="span2">
	{% if user.is_authenticated and username == user.username %}
	<a class="pencil muted" id="trigger-editable-social" href="#"><b>Social</b><img src="{{ STATIC_URL }}img/pencil_dull.png"></a>
	{% endif %}
      </div>
      <div class="span10">
	{% if user.is_authenticated and username == user.username %}
	<span id="twitter-img" class="hide">{{ STATIC_URL }}img/twitter.png</span>
	<span id="facebook-img" class="hide">{{ STATIC_URL }}img/facebook.png</span>
	<span id="google_plus-img" class="hide">{{ STATIC_URL }}img/gplus.png</span>
	<span id="linkedin-img" class="hide">{{ STATIC_URL }}img/linkedin.png</span>
	<div id="editable-social">
	  {% if profile.twitter %}
	  <a id="valid-social-twitter" href="{{ profile.twitter }}" target="_blank" style="margin-right: 15px">
	    <img src="{{ STATIC_URL }}img/twitter.png">
	  </a>
	  {% endif %}
	  {% if profile.facebook %}
	  <a id="valid-social-facebook" href="{{ profile.facebook }}" target="_blank" style="margin-right: 15px">
	    <img src="{{ STATIC_URL }}img/facebook.png">
	  </a>
	  {% endif %}
	  {% if profile.google_plus %}
	  <a id="valid-social-google_plus" href="{{ profile.google_plus }}" target="_blank" style="margin-right: 15px">
	    <img src="{{ STATIC_URL }}img/gplus.png">
	  </a>
	  {% endif %}
	  {% if profile.linkedin %}
	  <a id="valid-social-linkedin" href="{{ profile.linkedin }}" target="_blank">
	    <img src="{{ STATIC_URL }}img/linkedin.png">
	  </a>
	  {% endif %}
	  {% if not profile.twitter and not profile.facebook and not profile.google_plus and not profile.linkedin %}
	  <p id="empty-social"><em>Currently empty</em></p>
	  {% endif %}
	  <div class="hide" id="twitter-group">
	    <label for="twitter-input" class="control-label">Twitter</label>
	    <input id="twitter-input" type="text" maxlength="500"></input>
	  </div>

	  <div class="hide" id="facebook-group">
	    <label for="facebook-input" class="control-label">Facebook</label>
	    <input id="facebook-input" type="text" maxlength="500"></input>
	  </div>

	  <div class="hide" id="google_plus-group">
	    <label for="google_plus_input" class="control-label">Google+</label>
	    <input id="google_plus-input" type="text" maxlength="500"></input>
	  </div>

	  <div class="hide" id="linkedin-group">
	    <label for="linkedin-input" class="control-label">LinkedIn</label>
	    <input id="linkedin-input" type="text" maxlength="500"></input>
	  </div>
	</div>
	<button type="button" class="btn btn-success" id="save-social" style="display: none; margin-bottom: 10px">
	  <b>Save</b>
	</button>
	<button type="button" class="btn btn-default" id="cancel-social" style="display: none; margin-bottom: 10px">
	  <i class="icon-remove"></i>
	</button>
	{% else %}
	{% if profile.twitter %}
	<a href="{{ profile.twitter }}" target="_blank" style="margin-right: 15px"><img src="{{ STATIC_URL }}img/twitter.png"></a>
	{% endif %}
	{% if profile.facebook %}
	<a href="{{ profile.facebook }}" target="_blank" style="margin-right: 15px"><img src="{{ STATIC_URL }}img/facebook.png"></a>
	{% endif %}
	{% if profile.google_plus %}
	<a href="{{ profile.google_plus }}" target="_blank" style="margin-right: 15px"><img src="{{ STATIC_URL }}img/gplus.png"></a>
	{% endif %}
	{% if profile.linkedin %}
	<a href="{{ profile.linkedin }}" target="_blank" style="margin-right: 15px"><img src="{{ STATIC_URL }}img/linkedin.png"></a>
	{% endif %}
	{% endif %}
      </div>
    </div>
  </div>

  <div class="span3">
    {% if user.is_authenticated and username == user.username %}
    <div class="row-fluid" style="padding-bottom: 10px">
      <a href="#profile-picture-modal" role="button" data-toggle="modal" class="btn btn-success">
	<i class="icon-plus icon-white"></i><strong>Profile picture</strong>
      </a>
      {% if profile.picture %}
      <a href="#delete-profile-picture" role="button" data-toggle="modal" class="btn btn-danger">
	<i class="icon-remove icon-white"></i>
      </a>
      {% endif %}
    </div>
    {% endif %}

    {% if profile.picture %}
    <div class="row-fluid">
      <img src="{{ profile.picture.url }}">
    </div>
    {% endif %}
  </div>

</div>
{% endblock %}
