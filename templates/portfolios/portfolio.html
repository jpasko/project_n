{% extends "portfolio_base.html" %}
{% block title %}{{ profile.fullname }} | Portfolio{% endblock %}
{% block script %}
{% if user.is_authenticated and user.username == username %}
<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
<script src="{{ STATIC_URL }}js/confirm-delete.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/csrf.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/sorting.js"></script>
<script>
$(document).ready(function(){
  $("#toggle-directions").click(function(){
    $("#directions").toggle(200);
  });
});
</script>
{% endif %}
{% endblock %}
{% block header %}{% endblock %}
{% block content %}
{% if user.is_authenticated and user.username == username %}
{% if profile.photo_count > customer.account_limit %}
<h1 style="color: red">UPLOAD LIMIT EXCEEDED</h1>
<p style="color: orange"><em>You've exceeded your upload limit ({{ customer.account_limit }} uploads), probably because you downgraded
    your account. Please either <a href="/{{ username }}/settings">upgrade</a> your account or delete the excess 
    photos to re-enable your public portfolio.</em></p>
{% endif %}
<div id="dialog" title="Are you sure?">
  <p>
    <span class="ui-icon ui-icon-alert"></span>
    This gallery and all photos it contains will be permanently deleted.</p>
</div>
<a id="toggle-directions" style="cursor: pointer"><b>Toggle directions</b></a>
<ul class="muted" id="directions">
  <li><em><a href="create_gallery/">Create</a></em> a new gallery or use the <em>tools</em> drop-down menu (empty galleries won't be shown publicly)</li>
  <li><em><a href="edit/">Edit</a></em> your settings to customize your portfolio's style and create your profile</li>
  <li><em>Upload</em> photos into a gallery, <em>delete</em> a gallery, or <em>edit</em> the gallery's title</li>
  <li><em>Rearrange</em> galleries by dragging and dropping them</li>
</ul>
{% endif %}
<div class="row muted">
  <div class="span12">
    <ul class="thumbnails sortable-galleries">
      {% for gallery in galleries %}
      <li id="galleries_{{ gallery.pk }}">
	<div style="position: relative; left: 0; top: 0;">
	  {% if gallery.count > 0 %}
	  <a href="/{{ username }}/gallery/{{ gallery.pk }}/">
	    {% with first_photo=gallery.photo_set.all|first %}
	    {% if profile.portfolio_columns == 3 %}
	    <img src="{{ first_photo.thumbnail_3.url }}" style="position: relative; top: 0; left: 0;">
	    {% else %}
	    <img src="{{ first_photo.thumbnail_1.url }}" style="position: relative; top: 0; left: 0;">
	    {% endif %}
	    {% endwith %}
	  </a>
	  {% else %}
	  <img src="{{ STATIC_URL }}img/empty_gallery.png">
	  {% endif %}
	  {% if user.is_authenticated and username == user.username %}
	  <a href="/{{ username }}/upload/{{ gallery.pk }}/">
	    <img src="{{ STATIC_URL }}img/upload.png" style="position: absolute; top: 0; left: 0;"/>
	  </a>
	  {% if gallery.count > 0 %}
	  <a href="/{{ username }}/gallery/{{ gallery.pk }}/delete/" class="confirm">
	  {% else %}
	  <a href="/{{ username }}/gallery/{{ gallery.pk }}/delete/">
	  {% endif %}
	    <img src="{{ STATIC_URL }}img/delete.png" style="position: absolute; top: 0; right: 0;"/>
	  </a>
	  <a href="http://google.com">
	    <img src="{{ STATIC_URL }}img/edit.png" style="position: absolute; bottom: 0; left: 0;"/>
	  </a>
	  {% endif %}
	</div>
	{% if gallery.count > 0 %}
        <p style="text-align: center"><b>{{ gallery.title }}</b></p>
	{% else %}
        <p style="text-align: center"><b>{{ gallery.title }}(empty)</b></p>
	{% endif %}
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endblock %}
